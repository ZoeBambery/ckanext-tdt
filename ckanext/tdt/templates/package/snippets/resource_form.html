{% ckan_extends %}

  {% block metadata_fields %}
    <script id="resource_content" type="application/json">{{ h.jsondump(data)|safe }}</script>

    {{ super() }}

    {% resource 'ckanext-tdt/js/tdt.js' %}
    {% resource 'ckanext-tdt/css/tdt.css' %}

    <script>
        var TDT_HOST = "{{ h.tdt_host()|safe }}"
        var TDT_MANDATORY_PARAMS = "{{ h.tdt_mandatory_params()|safe }}".trim().split(" ")
    </script>
    <div id="tdt_block">
        <div class="control-group control-full">
            <label class="control-label" for="field-enable-tdt">Use TheDataTank</label>
            <div class="controls"><input type="checkbox" {{ "CHECKED" if 'enable-tdt' in data }} onchange="TDT.checkTDTFieldsDisplay()" id="field-enable-tdt" name="enable-tdt" placeholder="Whether to use TheDataTank to proxy the resource."></div>
        </div>
        <div id="tdt_inputs">
            <div id="tdt_required_inputs"></div>
            <div id="tdt_optional_toggle" onclick="TDT.displayOptionalInputs()"><i class="icon-plus"></i>optional parameters<i class="icon-plus"></i></div>
            <div id="tdt_optional_inputs"></div>
        </div>
    </div>

    </div>
  {% endblock %}

